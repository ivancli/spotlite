{"version":3,"sources":["manage_dashboard.js"],"names":[],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"dashboard.js","sourcesContent":["/**\n * Created by ivan.li on 12/5/2016.\n */\n\nfunction showAddDashboardForm(el) {\n    showLoading();\n    $.ajax({\n        \"url\": '/dashboard/create',\n        \"method\": 'get',\n        \"success\": function (html) {\n            hideLoading();\n            var $modal = $(html);\n            $modal.modal();\n            $modal.on(\"shown.bs.modal\", function () {\n                if ($.isFunction(modalReady)) {\n                    modalReady({\n                        \"callback\": function (response) {\n                            if (response.status == true && typeof response.dashboard != 'undefined') {\n                                window.location.href = response.dashboard.urls.show;\n                            }\n                        }\n                    })\n                }\n            });\n            $modal.on(\"hidden.bs.modal\", function () {\n                $(\"#modal-dashboard-store\").remove();\n            });\n        },\n        \"error\": function (xhr, status, error) {\n            hideLoading();\n            describeServerRespondedError(xhr.status);\n        }\n    })\n}\n\nfunction showEditDashboardForm(el) {\n    showLoading();\n    $.ajax({\n        \"url\": $(el).attr(\"data-url\"),\n        \"method\": 'get',\n        \"success\": function (html) {\n            hideLoading();\n            var $modal = $(html);\n            $modal.modal();\n            $modal.on(\"shown.bs.modal\", function () {\n                if ($.isFunction(modalReady)) {\n                    modalReady({\n                        \"callback\": function (response) {\n//                                    tblDashboard.ajax.reload();\n                            window.location.reload();\n                        }\n                    })\n                }\n            });\n            $modal.on(\"hidden.bs.modal\", function () {\n                $(\"#modal-dashboard-update\").remove();\n            });\n        },\n        \"error\": function (xhr, status, error) {\n            hideLoading();\n            describeServerRespondedError(xhr.status);\n        }\n    })\n}\n\nfunction deleteDashboard(el) {\n//     confirmP(\"Delete dashboard\", \"Do you want to delete this dashboard?\", {\n//         \"affirmative\": {\n//             \"text\": \"Delete\",\n//             \"class\": \"btn-danger btn-flat\",\n//             \"dismiss\": true,\n//             \"callback\": function () {\n//                 showLoading();\n//                 $.ajax({\n//                     \"url\": $(el).attr(\"data-url\"),\n//                     \"method\": \"delete\",\n//                     \"dataType\": \"json\",\n//                     \"success\": function (response) {\n//                         hideLoading();\n//                         if (response.status == true) {\n// //                                    tblDashboard.row($(el).closest(\"tr\")).remove().draw();\n//                             window.location.href = \"/\";\n//                         } else {\n//                             alertP(\"Error\", \"Unable to delete dashboard, please try again later.\");\n//                         }\n//                     },\n//                     \"error\": function (xhr, status, error) {\n//                         hideLoading();\n//                         describeServerRespondedError(xhr.status);\n//                     }\n//                 })\n//             }\n//         },\n//         \"negative\": {\n//             \"text\": \"Cancel\",\n//             \"class\": \"btn-default btn-flat\",\n//             \"dismiss\": true\n//         }\n//     });\n    deletePopup(\"Delete Dashboard\", \"Are you sure you want to delete this dashboard?\",\n        \"By deleting this dashboard, you will lose the following data:\",\n        [\n            \"All charts in this dashboard\"\n        ],\n        {\n            \"affirmative\": {\n                \"text\": \"Delete\",\n                \"class\": \"btn-danger btn-flat\",\n                \"dismiss\": true,\n                \"callback\": function () {\n                    showLoading();\n                    $.ajax({\n                        \"url\": $(el).attr(\"data-url\"),\n                        \"method\": \"delete\",\n                        \"dataType\": \"json\",\n                        \"success\": function (response) {\n                            hideLoading();\n                            if (response.status == true) {\n//                                    tblDashboard.row($(el).closest(\"tr\")).remove().draw();\n                                window.location.href = \"/\";\n                            } else {\n                                alertP(\"Error\", \"Unable to delete dashboard, please try again later.\");\n                            }\n                        },\n                        \"error\": function (xhr, status, error) {\n                            hideLoading();\n                            describeServerRespondedError(xhr.status);\n                        }\n                    })\n                }\n            },\n            \"negative\": {\n                \"text\": \"Cancel\",\n                \"class\": \"btn-default btn-flat\",\n                \"dismiss\": true\n            }\n        });\n}\n\nfunction updateDashboardDirectionIcon() {\n    $(\"span.btn-reorder-dashboard\").each(function (index) {\n        if (index == 0) {\n            $(this).find(\"i\").removeClass(\"fa-arrow-up\").addClass(\"fa-arrow-down\");\n        } else {\n            $(this).find(\"i\").removeClass(\"fa-arrow-down\").addClass(\"fa-arrow-up\");\n        }\n    });\n}\n\nfunction swapDashboard(el) {\n    var $li = $(el).closest(\"li\");\n    if ($(el).is(\".btn-reorder-dashboard:first\")) {\n        $li.next(\"li\").after($li);\n    } else {\n        $li.prev(\"li\").before($li);\n    }\n    updateDashboardDirectionIcon();\n    updateDashboardOrder();\n}\n\n/*TODO create front-end reordering function*/\nfunction assignDashboardOrderNumber() {\n    $(\".btn-reorder-dashboard\").each(function (index) {\n        $(this).attr(\"data-order\", index);\n    });\n}\n\nfunction updateDashboardOrder() {\n    assignDashboardOrderNumber();\n    var orderList = [];\n    $(\".btn-reorder-dashboard\").each(function () {\n        if ($(this).attr(\"data-dashboard-id\")) {\n            var dashboardId = $(this).attr(\"data-dashboard-id\");\n            var dashboardOrder = parseInt($(this).attr(\"data-order\"));\n            orderList.push({\n                \"dashboard_id\": dashboardId,\n                \"dashboard_order\": dashboardOrder\n            });\n        }\n    });\n    $.ajax({\n        \"url\": \"/dashboard/order\",\n        \"method\": \"put\",\n        \"data\": {\n            \"order\": orderList\n        },\n        \"success\": function () {\n            hideLoading();\n        },\n        \"error\": function (xhr, status, error) {\n            hideLoading();\n            describeServerRespondedError(xhr.status);\n        }\n    });\n}"]}