{"version":3,"sources":["manage_dashboard.js"],"names":[],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"dashboard.js","sourcesContent":["/**\r\n * Created by ivan.li on 12/5/2016.\r\n */\r\n\r\nfunction showAddDashboardForm(el) {\r\n    showLoading();\r\n    $.ajax({\r\n        \"url\": '/dashboard/create',\r\n        \"method\": 'get',\r\n        \"success\": function (html) {\r\n            hideLoading();\r\n            var $modal = $(html);\r\n            $modal.modal();\r\n            $modal.on(\"shown.bs.modal\", function () {\r\n                if ($.isFunction(modalReady)) {\r\n                    modalReady({\r\n                        \"callback\": function (response) {\r\n                            if (response.status == true && typeof response.dashboard != 'undefined') {\r\n                                window.location.href = response.dashboard.urls.show;\r\n                            }\r\n                        }\r\n                    })\r\n                }\r\n            });\r\n            $modal.on(\"hidden.bs.modal\", function () {\r\n                $(\"#modal-dashboard-store\").remove();\r\n            });\r\n        },\r\n        \"error\": function (xhr, status, error) {\r\n            hideLoading();\r\n            describeServerRespondedError(xhr.status);\r\n        }\r\n    })\r\n}\r\n\r\nfunction showEditDashboardForm(el) {\r\n    showLoading();\r\n    $.ajax({\r\n        \"url\": $(el).attr(\"data-url\"),\r\n        \"method\": 'get',\r\n        \"success\": function (html) {\r\n            hideLoading();\r\n            var $modal = $(html);\r\n            $modal.modal();\r\n            $modal.on(\"shown.bs.modal\", function () {\r\n                if ($.isFunction(modalReady)) {\r\n                    modalReady({\r\n                        \"callback\": function (response) {\r\n//                                    tblDashboard.ajax.reload();\r\n                            window.location.reload();\r\n                        }\r\n                    })\r\n                }\r\n            });\r\n            $modal.on(\"hidden.bs.modal\", function () {\r\n                $(\"#modal-dashboard-update\").remove();\r\n            });\r\n        },\r\n        \"error\": function (xhr, status, error) {\r\n            hideLoading();\r\n            describeServerRespondedError(xhr.status);\r\n        }\r\n    })\r\n}\r\n\r\nfunction deleteDashboard(el) {\r\n    confirmP(\"Delete dashboard\", \"Do you want to delete this dashboard?\", {\r\n        \"affirmative\": {\r\n            \"text\": \"Delete\",\r\n            \"class\": \"btn-danger btn-flat\",\r\n            \"dismiss\": true,\r\n            \"callback\": function () {\r\n                showLoading();\r\n                $.ajax({\r\n                    \"url\": $(el).attr(\"data-url\"),\r\n                    \"method\": \"delete\",\r\n                    \"dataType\": \"json\",\r\n                    \"success\": function (response) {\r\n                        hideLoading();\r\n                        if (response.status == true) {\r\n//                                    tblDashboard.row($(el).closest(\"tr\")).remove().draw();\r\n                            window.location.href = \"/\";\r\n                        } else {\r\n                            alertP(\"Error\", \"Unable to delete dashboard, please try again later.\");\r\n                        }\r\n                    },\r\n                    \"error\": function (xhr, status, error) {\r\n                        hideLoading();\r\n                        describeServerRespondedError(xhr.status);\r\n                    }\r\n                })\r\n            }\r\n        },\r\n        \"negative\": {\r\n            \"text\": \"Cancel\",\r\n            \"class\": \"btn-default btn-flat\",\r\n            \"dismiss\": true\r\n        }\r\n    })\r\n}\r\n\r\nfunction updateDashboardDirectionIcon() {\r\n    $(\"span.btn-reorder-dashboard\").each(function (index) {\r\n        if (index == 0) {\r\n            $(this).find(\"i\").removeClass(\"fa-arrow-up\").addClass(\"fa-arrow-down\");\r\n        } else {\r\n            $(this).find(\"i\").removeClass(\"fa-arrow-down\").addClass(\"fa-arrow-up\");\r\n        }\r\n    });\r\n}\r\n\r\nfunction swapDashboard(el) {\r\n    var $li = $(el).closest(\"li\");\r\n    if ($(el).is(\".btn-reorder-dashboard:first\")) {\r\n        $li.next(\"li\").after($li);\r\n    } else {\r\n        $li.prev(\"li\").before($li);\r\n    }\r\n    updateDashboardDirectionIcon();\r\n    updateDashboardOrder();\r\n}\r\n\r\n/*TODO create front-end reordering function*/\r\nfunction assignDashboardOrderNumber() {\r\n    $(\".btn-reorder-dashboard\").each(function (index) {\r\n        $(this).attr(\"data-order\", index);\r\n    });\r\n}\r\n\r\nfunction updateDashboardOrder() {\r\n    assignDashboardOrderNumber();\r\n    var orderList = [];\r\n    $(\".btn-reorder-dashboard\").each(function () {\r\n        if ($(this).attr(\"data-dashboard-id\")) {\r\n            var dashboardId = $(this).attr(\"data-dashboard-id\");\r\n            var dashboardOrder = parseInt($(this).attr(\"data-order\"));\r\n            orderList.push({\r\n                \"dashboard_id\": dashboardId,\r\n                \"dashboard_order\": dashboardOrder\r\n            });\r\n        }\r\n    });\r\n    $.ajax({\r\n        \"url\": \"/dashboard/order\",\r\n        \"method\": \"put\",\r\n        \"data\": {\r\n            \"order\": orderList\r\n        },\r\n        \"success\": function () {\r\n            hideLoading();\r\n        },\r\n        \"error\": function (xhr, status, error) {\r\n            hideLoading();\r\n            describeServerRespondedError(xhr.status);\r\n        }\r\n    });\r\n}"]}