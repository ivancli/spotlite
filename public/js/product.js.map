{"version":3,"sources":["single_category.js","single_product.js","single_site.js"],"names":[],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACvVA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACrjBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"product.js","sourcesContent":["function btnDeleteCategoryOnClick(el) {\n    deletePopup(\"Delete Category\", \"Are you sure you want to delete this Category?\",\n        \"By deleting this category, you will lose the following:\",\n        [\n            \"All Products you have added\",\n            \"All URLs you have added\",\n            \"All Category and Product Charts generated, including any Charts displayed on your Dashboards\",\n            \"All Category Reports generated\",\n            \"This Category's pricing information tracked to date\"\n        ],\n        {\n            \"affirmative\": {\n                \"text\": \"DELETE\",\n                \"class\": \"btn-danger btn-flat\",\n                \"dismiss\": true,\n                \"callback\": function () {\n                    var $form = $(el).closest(\".frm-delete-category\");\n                    showLoading();\n                    $.ajax({\n                        \"url\": $form.attr(\"action\"),\n                        \"method\": \"delete\",\n                        \"data\": $form.serialize(),\n                        \"dataType\": \"json\",\n                        \"success\": function (response) {\n                            hideLoading();\n                            if (response.status == true) {\n                                gaDeleteCategory();\n                                alertP(\"Delete Category\", \"Category has been deleted.\");\n                                $(el).closest(\".category-wrapper\").remove();\n                                updateUserProductCredit();\n                            } else {\n                                if (typeof response.errors != 'undefined') {\n                                    var errorMessage = \"\";\n                                    $.each(response.errors, function (index, error) {\n                                        errorMessage += error + \" \";\n                                    });\n                                    alertP(\"Oops! Something went wrong.\", errorMessage);\n                                } else {\n                                    alertP(\"Oops! Something went wrong.\", \"Unable to delete category, please try again later.\");\n                                }\n                            }\n                        },\n                        \"error\": function (xhr, status, error) {\n                            hideLoading();\n                            describeServerRespondedError(xhr.status);\n                        }\n                    })\n                }\n            },\n            \"negative\": {\n                \"text\": \"CANCEL\",\n                \"class\": \"btn-default btn-flat\",\n                \"dismiss\": true\n            }\n        });\n}\n\nfunction appendCreateProductBlock(el) {\n    $(el).find(\".add-item-label\").slideUp();\n    $(el).find(\".add-item-controls\").slideDown();\n}\n\nfunction appendUpgradeForCreateProductBlock(el) {\n    $(el).find(\".add-item-label\").slideUp();\n    $(el).find(\".upgrade-for-add-item-controls\").slideDown();\n}\n\nfunction cancelAddProduct(el) {\n    $(el).closest(\".add-item-block\").find(\".add-item-label\").slideDown();\n    $(el).closest(\".add-item-block\").find(\".add-item-controls\").slideUp();\n    $(el).closest(\".add-item-block\").find(\".add-item-controls input\").val(\"\");\n}\n\n\nfunction btnAddProductOnClick(el) {\n    showLoading();\n    var $categoryWrapper = $(el).closest(\".category-wrapper\");\n    $.ajax({\n        \"url\": \"/product\",\n        \"method\": \"post\",\n        \"data\": {\n            \"category_id\": $(el).closest(\".category-wrapper\").attr('data-category-id'),\n            \"product_name\": $categoryWrapper.find(\".frm-store-product\").find(\".txt-product-name\").val(),\n            \"meta\": {\n                \"brand\": $categoryWrapper.find(\".frm-store-product\").find(\".txt-product-meta-brand\").val(),\n                \"supplier\": $categoryWrapper.find(\".frm-store-product\").find(\".txt-product-meta-supplier\").val(),\n                \"sku\": $categoryWrapper.find(\".frm-store-product\").find(\".txt-product-meta-sku\").val(),\n                \"cost_price\": $categoryWrapper.find(\".frm-store-product\").find(\".txt-product-meta-cost-price\").val()\n            }\n        },\n        \"dataType\": \"json\",\n        \"success\": function (response) {\n            hideLoading();\n            if (response.status == true) {\n                cancelAddProduct($(el).closest(\".category-wrapper\").find(\".btn-cancel-add-product\"));\n                gaAddProduct();\n                if (response.product != null) {\n                    showLoading();\n                    loadSingleProduct(response.product.urls.show, function (html) {\n                        hideLoading();\n                        $(el).closest(\".tbl-category\").find(\".collapsible-category-div\").prepend(html);\n                        updateProductOrder($(el).closest(\".category-wrapper\").attr('data-category-id'));\n                        updateProductEmptyMessage();\n                        updateUserProductCredit();\n                    });\n                } else {\n                    alertP(\"Create product\", \"product has been created. But encountered error while page being loaded.\", function () {\n                        window.location.reload();\n                    });\n                }\n            } else {\n                alertP(\"Oops! Something went wrong.\", 'Unable to add product, please try again later.');\n            }\n        },\n        \"error\": function (xhr, status, error) {\n            hideLoading();\n            if (xhr.responseJSON != null && typeof xhr.responseJSON != 'undefined') {\n                var errorMsg = \"\";\n                $.each(xhr.responseJSON, function (key, error) {\n                    $.each(error, function (index, message) {\n                        errorMsg += message + \" \";\n                    })\n                });\n                alertP(\"Oops! Something went wrong.\", errorMsg);\n            } else {\n                describeServerRespondedError(xhr.status);\n            }\n        }\n    })\n}\n\nfunction loadSingleProduct(url, callback) {\n    $.ajax({\n        \"url\": url,\n        \"method\": \"get\",\n        \"success\": callback,\n        \"error\": function (xhr, status, error) {\n            hideLoading();\n            describeServerRespondedError(xhr.status);\n        }\n    });\n}\n\n\nfunction toggleEditCategoryName(el) {\n    var $tbl = $(el).closest(\".tbl-category\");\n    if ($tbl.find(\".btn-edit-category\").hasClass(\"editing\")) {\n        $tbl.find(\".btn-edit-category\").removeClass(\"editing\").show();\n        $tbl.find(\".category-name-link\").show();\n        $tbl.find(\".frm-edit-category\").hide();\n    } else {\n        $tbl.find(\".btn-edit-category\").addClass(\"editing\").hide();\n        $tbl.find(\"input.category-name\").val($tbl.find(\".category-name-link\").text());\n        $tbl.find(\".category-name-link\").hide();\n        $tbl.find(\".frm-edit-category\").show();\n        $tbl.find(\".frm-edit-category .category-name\").focus();\n    }\n}\n\nfunction cancelEditCategoryName(el, event) {\n    if (typeof event == 'undefined' || typeof event.keyCode == 'undefined') {\n        toggleEditCategoryName(el);\n    } else if (event.keyCode == 27) {\n        $(el).blur();\n    }\n}\n\nfunction txtCategoryOnBlur(el) {\n    setTimeout(function () {\n        if (!$(\":focus\").is($(el).siblings(\"span\").find(\"button\"))) {\n            cancelEditCategoryName(el);\n        }\n    }, 10);\n}\n\nfunction submitEditCategoryName(el) {\n    showLoading();\n    $.ajax({\n        \"url\": $(el).attr(\"action\"),\n        \"method\": \"put\",\n        \"data\": $(el).serialize(),\n        \"dataType\": \"json\",\n        \"success\": function (response) {\n            hideLoading();\n            if (response.status == true) {\n                gaEditCategory();\n                alertP(\"Update Category\", \"Category name has been updated.\");\n                $(el).siblings(\".category-name-link\").text($(el).find(\".category-name\").val()).show();\n                $(el).hide();\n                $(el).closest(\".tbl-category\").find(\".btn-edit-category.editing\").removeClass(\"editing\").show();\n            } else {\n                alertP(\"Oops! Something went wrong.\", 'Unable to update category name, please try again later.');\n            }\n        },\n        \"error\": function (xhr, status, error) {\n            hideLoading();\n            if (xhr.responseJSON != null && typeof xhr.responseJSON != 'undefined') {\n                var errorMsg = \"\";\n                $.each(xhr.responseJSON, function (key, error) {\n                    $.each(error, function (index, message) {\n                        errorMsg += message + \" \";\n                    })\n                });\n                alertP(\"Oops! Something went wrong.\", errorMsg);\n            } else {\n                describeServerRespondedError(xhr.status);\n            }\n        }\n    });\n}\n\nfunction assignProductOrderNumber(category_id) {\n    $(\".category-wrapper\").filter(function () {\n        return $(this).attr(\"data-category-id\") == category_id;\n    }).find(\".product-wrapper\").each(function (index) {\n        $(this).attr(\"data-order\", index + 1);\n    });\n}\n\nfunction updateProductOrder(category_id) {\n    assignProductOrderNumber(category_id);\n    var orderList = [];\n    $(\".category-wrapper\").filter(function () {\n        return $(this).attr(\"data-category-id\") == category_id;\n    }).find(\".product-wrapper\").filter(function () {\n        return !$(this).hasClass(\"gu-mirror\");\n    }).each(function () {\n        if ($(this).attr(\"data-product-id\")) {\n            var productId = $(this).attr(\"data-product-id\");\n            var productOrder = parseInt($(this).attr(\"data-order\"));\n            orderList.push({\n                \"product_id\": productId,\n                \"product_order\": productOrder\n            });\n        }\n    });\n    $.ajax({\n        \"url\": \"product/order\",\n        \"method\": \"put\",\n        \"data\": {\n            \"order\": orderList\n        },\n        \"dataType\": \"json\",\n        \"success\": function (response) {\n            if (response.status == false) {\n                if (typeof response.errors != 'undefined') {\n                    var errorMessage = \"\";\n                    $.each(response.errors, function (index, error) {\n                        errorMessage += error + \" \";\n                    });\n                    alertP(\"Oops! Something went wrong.\", errorMessage);\n                } else {\n                    alertP(\"Oops! Something went wrong.\", \"Unable to update product order, please try again later.\");\n                }\n            } else {\n                gaMoveProduct();\n            }\n        },\n        \"error\": function (xhr, status, error) {\n            describeServerRespondedError(xhr.status);\n        }\n    })\n}\n\nfunction showCategoryChart(url) {\n    showLoading();\n    $.ajax({\n        \"url\": url,\n        \"method\": \"get\",\n        \"success\": function (html) {\n            hideLoading();\n            var $modal = $(html);\n            $modal.modal();\n            $modal.on(\"shown.bs.modal\", function () {\n                if ($.isFunction(modalReady)) {\n                    modalReady()\n                }\n            });\n            $modal.on(\"hidden.bs.modal\", function () {\n                $(this).remove();\n            });\n        },\n        \"error\": function (xhr, status, error) {\n            hideLoading();\n            describeServerRespondedError(xhr.status);\n        }\n    });\n}\n\n\nfunction showCategoryReportTaskForm(el) {\n    showLoading();\n    $.ajax({\n        \"url\": $(el).closest(\".category-wrapper\").attr(\"data-report-task-link\"),\n        \"method\": \"get\",\n        \"success\": function (html) {\n            hideLoading();\n            var $modal = $(html);\n            $modal.modal();\n            $modal.on(\"shown.bs.modal\", function () {\n                if ($.isFunction(modalReady)) {\n                    modalReady({\n                        \"updateCallback\": function (response) {\n                            if (response.status == true) {\n                                $(el).find(\"i\").removeClass().addClass(\"fa fa-envelope ico-report-enabled\");\n                            }\n                        },\n                        \"deleteCallback\": function (response) {\n                            if (response.status == true) {\n                                $(el).find(\"i\").removeClass().addClass(\"fa fa-envelope-o\");\n                            }\n                        }\n                    })\n                }\n            });\n            $modal.on(\"hidden.bs.modal\", function () {\n                $(\"#modal-report-task-category\").remove();\n            });\n        },\n        \"error\": function (xhr, status, error) {\n            hideLoading();\n            describeServerRespondedError(xhr.status);\n        }\n    });\n}\n\n\nfunction updateUserSiteUsage(el) {\n    $.ajax({\n        \"url\": $(el).closest(\".category-wrapper\").attr(\"data-get-site-usage-link\"),\n        \"method\": \"get\",\n        \"dataType\": \"json\",\n        \"success\": function (response) {\n            if (response.status == true) {\n                var usage = response.usage;\n                var $categoryWrapper = $(el).closest(\".category-wrapper\")\n                $categoryWrapper.find(\".lbl-site-usage\").text(usage);\n            }\n        },\n        \"error\": function (xhr, status, error) {\n            describeServerRespondedError(xhr.status);\n        }\n    })\n}","/**\n * set order number to element\n * @param product_id\n */\nfunction assignSiteOrderNumber(product_id) {\n    $(\".product-wrapper\").filter(function () {\n        return $(this).attr(\"data-product-id\") == product_id;\n    }).find(\".site-wrapper\").each(function (index) {\n        $(this).attr(\"data-order\", index + 1);\n    });\n}\n\n/**\n * Send order number to server\n * @param product_id\n */\nfunction updateSiteOrder(product_id) {\n    assignSiteOrderNumber(product_id);\n    var orderList = [];\n    $(\".product-wrapper\").filter(function () {\n        return $(this).attr(\"data-product-id\") == product_id;\n    }).find(\".site-wrapper\").filter(function () {\n        return !$(this).hasClass(\"gu-mirror\");\n    }).each(function () {\n        if ($(this).attr(\"data-site-id\")) {\n            var siteId = $(this).attr(\"data-site-id\");\n            var siteOrder = parseInt($(this).attr(\"data-order\"));\n            orderList.push({\n                \"site_id\": siteId,\n                \"site_order\": siteOrder\n            });\n        }\n    });\n    $.ajax({\n        \"url\": \"/site/order\",\n        \"method\": \"put\",\n        \"data\": {\n            \"order\": orderList\n        },\n        \"dataType\": \"json\",\n        \"success\": function (response) {\n            if (response.status == false) {\n                if (typeof response.errors != 'undefined') {\n                    var errorMessage = \"\";\n                    $.each(response.errors, function (index, error) {\n                        errorMessage += error + \" \";\n                    });\n                    alertP(\"Oops! Something went wrong.\", errorMessage);\n                } else {\n                    alertP(\"Oops! Something went wrong.\", \"Unable to update site order, please try again later.\");\n                }\n            } else {\n                gaMoveSite();\n            }\n        },\n        \"error\": function (xhr, status, error) {\n            describeServerRespondedError(xhr.status);\n        }\n    })\n}\nfunction appendCreateSiteBlock(el) {\n    $(el).find(\".add-item-label\").slideUp();\n    $(el).find(\".add-item-controls\").slideDown();\n    $(el).find(\".txt-site-url\").focus();\n}\nfunction appendUpgradeForCreateSiteBlock(el) {\n    $(el).find(\".add-item-label\").slideUp();\n    $(el).find(\".upgrade-for-add-item-controls\").slideDown();\n}\n/**\n * disable add site\n * @param el\n */\nfunction cancelAddSite(el) {\n    $(el).closest(\".add-item-block\").find(\".add-item-label\").slideDown();\n    $(el).closest(\".add-item-block\").find(\".add-item-controls\").slideUp();\n    $(el).closest(\".add-item-block\").find(\".add-item-controls input\").val(\"\");\n}\nfunction getPricesCreate(el) {\n    var $addItemControls = $(el).closest(\".add-item-controls\");\n    var $txtSiteURL = $addItemControls.find(\".txt-site-url\");\n    var productID = $(el).closest(\".product-wrapper\").attr(\"data-product-id\");\n    showLoading();\n    $.ajax({\n        \"url\": \"/site/prices\",\n        \"method\": \"post\",\n        \"data\": {\n            \"site_url\": $txtSiteURL.val()\n        },\n        \"dataType\": \"json\",\n        \"success\": function (response) {\n            if (typeof response.errors == 'undefined') {\n                if ((typeof response.sites == 'undefined' || response.sites.length == 0) && typeof response.targetDomain == 'undefined') {\n                    addSite({\n                        \"site_url\": $txtSiteURL.val(),\n                        \"product_id\": productID\n                    }, function (add_site_response) {\n                        alertP(\"Added Product Page URL\", \"This price will be updated soon. Note: If it doesn't come up in up to 48 hours, please contact us.\");\n                        if (add_site_response.status == true) {\n                            loadSingleSite(add_site_response.site.urls.show, function (html) {\n                                $(el).closest(\".tbl-site\").find(\"tbody\").prepend(html);\n                                cancelAddSite($addItemControls.find(\".btn-cancel-add-site\").get(0));\n                                updateProductEmptyMessage();\n                                updateUserSiteUsage(el);\n                                updateUserSiteUsagePerProduct(el);\n                            });\n                        } else {\n                            if (typeof response.errors != 'undefined') {\n                                var errorMessage = \"\";\n                                $.each(response.errors, function (index, error) {\n                                    errorMessage += error + \" \";\n                                });\n                                alertP(\"Oops! Something went wrong.\", errorMessage);\n                            } else {\n                                alertP(\"Oops! Something went wrong.\", \"Unable to add site, please try again later.\");\n                            }\n                        }\n                    })\n                } else {\n                    showLoading();\n                    $.ajax({\n                        \"url\": \"/site/prices\",\n                        \"method\": \"post\",\n                        \"data\": {\n                            \"site_url\": $txtSiteURL.val()\n                        },\n                        \"success\": function (html) {\n                            hideLoading();\n                            var $modal = $(html);\n                            $modal.modal();\n                            $modal.on(\"shown.bs.modal\", function () {\n                                if ($.isFunction(modalReady)) {\n                                    modalReady({\n                                        \"callback\": function (addSiteData) {\n                                            console.info(addSiteData);\n                                            addSite({\n                                                \"site_url\": $txtSiteURL.val(),\n                                                \"domain_id\": addSiteData.domain_id,\n                                                \"site_id\": addSiteData.site_id,\n                                                \"domain_price\": addSiteData.domain_price,\n                                                \"product_id\": productID,\n                                                \"comment\": addSiteData.comment\n                                            }, function (add_site_response) {\n                                                if (add_site_response.status == true) {\n                                                    loadSingleSite(add_site_response.site.urls.show, function (html) {\n                                                        $(el).closest(\".tbl-site\").find(\"tbody\").prepend(html);\n                                                        cancelAddSite($addItemControls.find(\".btn-cancel-add-site\").get(0));\n                                                        updateProductEmptyMessage();\n                                                        updateUserSiteUsage(el);\n                                                        updateUserSiteUsagePerProduct(el);\n                                                    });\n                                                } else {\n                                                    if (typeof response.errors != 'undefined') {\n                                                        var errorMessage = \"\";\n                                                        $.each(response.errors, function (index, error) {\n                                                            errorMessage += error + \" \";\n                                                        });\n                                                        alertP(\"Oops! Something went wrong.\", errorMessage);\n                                                    } else {\n                                                        alertP(\"Oops! Something went wrong.\", \"Unable to add site, please try again later.\");\n                                                    }\n                                                }\n                                                /*TODO big pb*/\n                                            });\n                                        }\n                                    })\n                                }\n                            });\n                            $modal.on(\"hidden.bs.modal\", function () {\n                                $(\"#modal-site-prices\").remove();\n                            });\n                        },\n                        \"error\": function (xhr, status, error) {\n                            hideLoading();\n                            if (xhr.responseJSON != null && typeof xhr.responseJSON != 'undefined') {\n                                var errorMsg = \"\";\n                                $.each(xhr.responseJSON, function (key, error) {\n                                    $.each(error, function (index, message) {\n                                        errorMsg += message + \" \";\n                                    })\n                                });\n                                alertP(\"Oops! Something went wrong.\", errorMsg);\n                            } else {\n                                describeServerRespondedError(xhr.status);\n                            }\n                        }\n                    });\n                }\n            } else {\n                hideLoading();\n                alertP(\"Oops! Something went wrong.\", 'Unable to add Product Page URL, please try again later.');\n            }\n        },\n        \"error\": function (xhr, status, error) {\n            hideLoading();\n            if (xhr.responseJSON != null && typeof xhr.responseJSON != 'undefined') {\n                var errorMsg = \"\";\n                $.each(xhr.responseJSON, function (key, error) {\n                    $.each(error, function (index, message) {\n                        errorMsg += message + \" \";\n                    })\n                });\n                alertP(\"Oops! Something went wrong.\", errorMsg);\n            } else {\n                describeServerRespondedError(xhr.status);\n            }\n        }\n    })\n}\n\nfunction addSite(data, callback) {\n    showLoading();\n    $.ajax({\n        \"url\": \"/site\",\n        \"method\": \"post\",\n        \"data\": data,\n        \"dataType\": \"json\",\n        \"success\": function (response) {\n            hideLoading();\n            if ($.isFunction(callback)) {\n                callback(response);\n            }\n        },\n        \"error\": function (xhr, status, error) {\n            hideLoading();\n            if (xhr.responseJSON != null && typeof xhr.responseJSON != 'undefined') {\n                var errorMsg = \"\";\n                $.each(xhr.responseJSON, function (key, error) {\n                    $.each(error, function (index, message) {\n                        errorMsg += message + \" \";\n                    })\n                });\n                alertP(\"Oops! Something went wrong.\", errorMsg);\n            } else {\n                describeServerRespondedError(xhr.status);\n            }\n        }\n    })\n}\n\nfunction loadSingleSite(url, callback) {\n    showLoading();\n    $.ajax({\n        \"url\": url,\n        \"method\": \"get\",\n        \"success\": function (html) {\n            hideLoading();\n\n            if ($.isFunction(callback)) {\n                callback(html);\n            }\n        },\n        \"error\": function (xhr, status, error) {\n            hideLoading();\n            describeServerRespondedError(xhr.status);\n        }\n    });\n}\n\n\nfunction btnDeleteProductOnClick(el) {\n    deletePopup(\"Delete Product\", \"Are you sure you want to delete this Product?\",\n        \"By deleting this product, you will lose the following:\",\n        [\n            \"All URLs you have added\",\n            \"All Product charts generated, including any Charts displayed on your Dashboards\",\n            \"All Product Reports generated\",\n            \"All Alerts set up for this Product\",\n            \"This Product's pricing information tracked to date\"\n        ],\n        {\n            \"affirmative\": {\n                \"text\": \"DELETE\",\n                \"class\": \"btn-danger btn-flat\",\n                \"dismiss\": true,\n                \"callback\": function () {\n                    var $form = $(el).closest(\".frm-delete-product\");\n                    showLoading();\n                    $.ajax({\n                        \"url\": $form.attr(\"action\"),\n                        \"method\": \"delete\",\n                        \"data\": $form.serialize(),\n                        \"dataType\": \"json\",\n                        \"success\": function (response) {\n                            hideLoading();\n                            if (response.status == true) {\n                                gaDeleteProduct();\n                                alertP(\"Delete Product\", \"Product has been deleted.\");\n                                updateUserSiteUsage(el);\n                                $(el).closest(\".product-wrapper\").remove();\n                                updateUserProductCredit();\n                            } else {\n                                if (typeof response.errors != 'undefined') {\n                                    var errorMessage = \"\";\n                                    $.each(response.errors, function (index, error) {\n                                        errorMessage += error + \" \";\n                                    });\n                                    alertP(\"Oops! Something went wrong.\", errorMessage);\n                                } else {\n                                    alertP(\"Oops! Something went wrong.\", \"Unable to delete product, please try again later.\");\n                                }\n                            }\n                        },\n                        \"error\": function (xhr, status, error) {\n                            hideLoading();\n                            describeServerRespondedError(xhr.status);\n                        }\n                    })\n                }\n            },\n            \"negative\": {\n                \"text\": \"CANCEL\",\n                \"class\": \"btn-default btn-flat\",\n                \"dismiss\": true\n            }\n        });\n}\n\nfunction toggleEditProductName(el) {\n    var $tbl = $(el).closest(\".product-wrapper\");\n    if ($tbl.find(\".btn-edit-product\").hasClass(\"editing\")) {\n        $tbl.find(\".btn-edit-product\").removeClass(\"editing\").show();\n        $tbl.find(\".frm-edit-product\").slideUp(function () {\n            $tbl.find(\".product-name-link\").slideDown();\n            $tbl.find('.product-info').show();\n        });\n    } else {\n        $tbl.find(\".btn-edit-product\").addClass(\"editing\").hide();\n        $tbl.find(\"input.product-name\").val($tbl.find(\".product-name-link\").text());\n        $tbl.find('.product-info').hide();\n        $tbl.find(\".product-name-link\").slideUp(function () {\n            $tbl.find(\".frm-edit-product\").slideDown();\n        });\n    }\n}\n\nfunction cancelEditProductName(el, event) {\n    if (typeof event == 'undefined' || typeof event.keyCode == 'undefined') {\n        toggleEditProductName(el);\n    } else if (event.keyCode == 27) {\n        $(el).blur();\n    }\n}\n\nfunction txtProductOnBlur(el) {\n    setTimeout(function () {\n        if (!$(\":focus\").is($(el).siblings(\"span\").find(\"button\"))) {\n            cancelEditProductName(el);\n        }\n    }, 10);\n}\n\nfunction submitEditProductName(el) {\n    showLoading();\n    var $productWrapper = $(el).closest(\".product-wrapper\");\n    var $form = $productWrapper.find(\".frm-edit-product\");\n    $.ajax({\n        \"url\": $form.attr(\"action\"),\n        \"method\": \"put\",\n        \"data\": $form.serialize(),\n        \"dataType\": \"json\",\n        \"success\": function (response) {\n            hideLoading();\n            if (response.status == true) {\n                gaEditProduct();\n                alertP(\"Update Product\", \"Product details have been updated.\");\n                $productWrapper.attr(\"data-product-meta-brand\", $form.find(\".txt-product-meta-brand\").val());\n                $productWrapper.attr(\"data-product-meta-supplier\", $form.find(\".txt-product-meta-supplier\").val());\n                $productWrapper.attr(\"data-product-meta-sku\", $form.find(\".txt-product-meta-sku\").val());\n                $productWrapper.attr(\"data-product-meta-cost-price\", $form.find(\".txt-product-meta-cost-price\").val());\n\n                $form.slideUp(function () {\n                    $form.siblings(\".product-name-link\").text($form.find(\".product-name\").val()).show();\n                    $productWrapper.find(\".btn-edit-product.editing\").removeClass(\"editing\").slideDown();\n                    $productWrapper.find('.product-info').show();\n                });\n            } else {\n                alertP(\"Oops! Something went wrong.\", 'Unable to update product details, please try again later.');\n            }\n        },\n        \"error\": function (xhr, status, error) {\n            hideLoading();\n            if (xhr.responseJSON != null && typeof xhr.responseJSON != 'undefined') {\n                var errorMsg = \"\";\n                $.each(xhr.responseJSON, function (key, error) {\n                    $.each(error, function (index, message) {\n                        errorMsg += message + \" \";\n                    })\n                });\n                alertP(\"Oops! Something went wrong.\", errorMsg);\n            } else {\n                describeServerRespondedError(xhr.status);\n            }\n        }\n    });\n}\n\nfunction showProductAlertForm(el) {\n    showLoading();\n    var productID = $(el).closest(\".product-wrapper\").attr(\"data-product-id\");\n\n    $.ajax({\n        \"url\": $(el).closest(\".product-wrapper\").attr(\"data-alert-link\"),\n        \"method\": \"get\",\n        \"data\": {\n            \"product_id\": productID\n        },\n        \"success\": function (html) {\n            hideLoading();\n            var $modal = $(html);\n            $modal.modal();\n            $modal.on(\"shown.bs.modal\", function () {\n                if ($.isFunction(modalReady)) {\n                    modalReady({\n                        \"updateCallback\": function (response) {\n                            if (response.status == true) {\n                                $(el).find(\"i\").removeClass().addClass(\"fa fa-bell alert-enabled\");\n                            }\n                        },\n                        \"deleteCallback\": function (response) {\n                            if (response.status == true) {\n                                $(el).find(\"i\").removeClass().addClass(\"fa fa-bell-o\");\n                            }\n                        }\n                    })\n                }\n            });\n            $modal.on(\"hidden.bs.modal\", function () {\n                $(\"#modal-alert-product\").remove();\n            });\n        },\n        \"error\": function (xhr, status, error) {\n            hideLoading();\n            describeServerRespondedError(xhr.status);\n        }\n    });\n}\n\nfunction showProductChart(url) {\n    showLoading();\n    $.ajax({\n        \"url\": url,\n        \"method\": \"get\",\n        \"success\": function (html) {\n            hideLoading();\n            var $modal = $(html);\n            $modal.modal();\n            $modal.on(\"shown.bs.modal\", function () {\n                if ($.isFunction(modalReady)) {\n                    modalReady()\n                }\n            });\n            $modal.on(\"hidden.bs.modal\", function () {\n                $(this).remove();\n            });\n        },\n        \"error\": function (xhr, status, error) {\n            hideLoading();\n            describeServerRespondedError(xhr.status);\n        }\n    });\n}\n\nfunction showProductReportTaskForm(el) {\n    showLoading();\n    $.ajax({\n        \"url\": $(el).closest(\".product-wrapper\").attr(\"data-report-task-link\"),\n        \"method\": \"get\",\n        \"success\": function (html) {\n            hideLoading();\n            var $modal = $(html);\n            $modal.modal();\n            $modal.on(\"shown.bs.modal\", function () {\n                if ($.isFunction(modalReady)) {\n                    modalReady({\n                        \"updateCallback\": function (response) {\n                            if (response.status == true) {\n                                $(el).find(\"i\").removeClass().addClass(\"fa fa-envelope ico-report-enabled\");\n                            }\n                        },\n                        \"deleteCallback\": function (response) {\n                            if (response.status == true) {\n                                $(el).find(\"i\").removeClass().addClass(\"fa fa-envelope-o\");\n                            }\n                        }\n                    })\n                }\n            });\n            $modal.on(\"hidden.bs.modal\", function () {\n                $(\"#modal-report-task-product\").remove();\n            });\n        },\n        \"error\": function (xhr, status, error) {\n            hideLoading();\n            describeServerRespondedError(xhr.status);\n        }\n    });\n}\n\nfunction updateProductEmptyMessage(el) {\n    function updateSingleProductEmptyMessage(el) {\n        var $tblSite = null;\n        if ($(el).hasClass(\"tbl-site\")) {\n            $tblSite = $(el);\n        } else {\n            $tblSite = $(el).find(\".tbl-site\");\n        }\n\n        var $bodyRow = $tblSite.find(\"tbody > tr\").filter(function () {\n            return !$(this).hasClass(\"empty-message-row\") && !$(this).hasClass(\"add-site-row\") && !$(this).hasClass(\"spinner-row\") && !$(this).hasClass(\"load-more-site\");\n        });\n        if ($bodyRow.length == 0) {\n            $tblSite.find(\".empty-message-row\").remove();\n            $tblSite.find(\"tbody\").prepend(\n                $(\"<tr>\").addClass(\"empty-message-row\").append(\n                    $(\"<td>\").attr({\n                        \"colspan\": 9\n                    }).addClass(\"text-center\").text(\"To start tracking prices, simply copy and paste the URL of the product page of the website your want to track.\")\n                )\n            )\n        } else {\n            $tblSite.find(\".empty-message-row\").remove();\n        }\n    }\n\n    if (typeof el != 'undefined') {\n        updateSingleProductEmptyMessage(el);\n    } else {\n        $(\".tbl-site\").each(function () {\n            updateSingleProductEmptyMessage(this);\n        })\n    }\n}\n\nfunction updateUserSiteUsagePerProduct(el) {\n    if (user.needSubscription) {\n        var $productWrapper = $(el).closest(\".product-wrapper\");\n        $.ajax({\n            \"url\": $productWrapper.attr(\"data-get-site-usage-per-product-link\"),\n            \"method\": \"get\",\n            \"dataType\": \"json\",\n            \"success\": function (response) {\n                if (response.status == true) {\n                    var total = response.total;\n                    var usage = response.usage;\n                    $productWrapper.find(\".lbl-site-usage-per-product\").text(usage);\n                    $productWrapper.find(\".lbl-site-total-per-product\").text(total);\n                    updateAddSitePanelStatus(usage, total, el);\n                }\n            },\n            \"error\": function (xhr, status, error) {\n                describeServerRespondedError(xhr.status);\n            }\n        })\n    }\n}\n\nfunction updateAddSitePanelStatus(usage, total, el) {\n    var $productWrapper = $(el).closest(\".product-wrapper\");\n    var $addSiteContainer = $productWrapper.find(\".add-site-container\");\n    if (total != 0 && usage >= total) {\n        $addSiteContainer.attr('onclick', 'appendUpgradeForCreateSiteBlock(this); event.stopPropagation(); return false;');\n    } else {\n        $addSiteContainer.attr('onclick', 'appendCreateSiteBlock(this); event.stopPropagation(); return false;');\n    }\n}","function btnDeleteSiteOnClick(el) {\n    deletePopup(\"Delete Product URL\", \"Are you sure you want to delete the \" + $(el).attr(\"data-name\") + \"?\",\n        \"By deleting this site, you will lose the following:\",\n        [\n            \"All pricing information related to this Site, including any information displayed on your Charts and Dashboards\",\n            \"All Product reports generated\",\n            \"All alerts set up for this Site\",\n            \"This Site's pricing information tracked to date\"\n        ],\n        {\n            \"affirmative\": {\n                \"text\": \"DELETE\",\n                \"class\": \"btn-danger btn-flat\",\n                \"dismiss\": true,\n                \"callback\": function () {\n                    var $form = $(el).closest(\".frm-delete-site\");\n                    showLoading();\n                    $.ajax({\n                        \"url\": $form.attr(\"action\"),\n                        \"method\": \"delete\",\n                        \"data\": $form.serialize(),\n                        \"dataType\": \"json\",\n                        \"success\": function (response) {\n                            hideLoading();\n                            if (response.status == true) {\n                                gaDeleteSite();\n                                alertP(\"Delete Product URL\", \"The Product URL has been deleted.\");\n                                updateUserSiteUsage(el);\n                                updateUserSiteUsagePerProduct(el);\n                                $(el).closest(\".site-wrapper\").remove();\n                            } else {\n                                if (typeof response.errors != 'undefined') {\n                                    var errorMessage = \"\";\n                                    $.each(response.errors, function (index, error) {\n                                        errorMessage += error + \" \";\n                                    });\n                                    alertP(\"Oops! Something went wrong.\", errorMessage);\n                                } else {\n                                    alertP(\"Oops! Something went wrong.\", \"Unable to delete this Product URL, please try again later.\");\n                                }\n                            }\n                            updateProductEmptyMessage();\n                        },\n                        \"error\": function (xhr, status, error) {\n                            hideLoading();\n                            if (xhr.responseJSON != null && typeof xhr.responseJSON != 'undefined') {\n                                var errorMsg = \"\";\n                                $.each(xhr.responseJSON, function (key, error) {\n                                    $.each(error, function (index, message) {\n                                        errorMsg += message + \" \";\n                                    })\n                                });\n                                alertP(\"Oops! Something went wrong.\", errorMsg);\n                            } else {\n                                describeServerRespondedError(xhr.status);\n                            }\n                        }\n                    })\n                }\n            },\n            \"negative\": {\n                \"text\": \"CANCEL\",\n                \"class\": \"btn-default btn-flat\",\n                \"dismiss\": true\n            }\n        });\n}\n\nfunction toggleEditSiteURL(el) {\n    var $tr = $(el).closest(\".site-wrapper\");\n    if ($tr.find(\".btn-edit-align-middle\").hasClass(\"editing\")) {\n        $tr.find(\".btn-edit-align-middle\").removeClass(\"editing\").show();\n        $tr.find(\".site-url-link\").show();\n        $tr.find(\".frm-edit-site-url\").hide();\n    } else {\n        $tr.find(\".btn-edit-align-middle\").addClass(\"editing\").hide();\n        $tr.find(\"input.txt-site-url\").val($tr.find(\".site-url-link\").attr(\"data-url\"));\n        $tr.find(\".site-url-link\").hide();\n        $tr.find(\".frm-edit-site-url\").show();\n        $tr.find(\".frm-edit-site-url .txt-site-url\").focus()\n    }\n}\n\nfunction cancelEditSiteURL(el, event) {\n    setTimeout(function(){\n        if (typeof event == 'undefined' || typeof event.keyCode == 'undefined') {\n            if ($(el).closest('.frm-edit-site-url').data('mouseDown') != true) {\n                toggleEditSiteURL(el);\n            }\n        } else if (event.keyCode == 27) {\n            $(el).blur();\n        }\n    }, 10);\n}\n\nfunction getPricesEdit(el) {\n    var $formEditSiteURL = $(el).closest(\".frm-edit-site-url\");\n    var $txtSiteURL = $formEditSiteURL.find(\".txt-site-url\");\n    var $siteWrapper = $(el).closest(\".site-wrapper\");\n    var siteID = $siteWrapper.attr(\"data-site-id\");\n    showLoading();\n    $.ajax({\n        \"url\": \"/site/prices\",\n        \"method\": \"post\",\n        \"data\": {\n            \"site_url\": $txtSiteURL.val(),\n            \"site_id\": siteID\n        },\n        \"dataType\": \"json\",\n        \"success\": function (response) {\n            hideLoading();\n            if (typeof response.errors == 'undefined') {\n                //PRICE NOT FOUND\n                if ((typeof response.sites == 'undefined' || response.sites.length == 0) && typeof response.targetDomain == 'undefined') {\n                    editSite({\n                        \"site_url\": $txtSiteURL.val(),\n                        \"url\": $(el).attr(\"data-url\")\n                    }, function (edit_site_response) {\n                        alertP(\"Updated Product Page URL\", \"This price will be updated soon. Note: If it doesn't come up in up to 48 hours, please contact us.\");\n                        if (edit_site_response.status == true) {\n                            loadSingleSite(edit_site_response.site.urls.show, function (html) {\n                                toggleEditSiteURL($(el).closest(\".site-wrapper\").find(\"btn-edit-site\").get(0));\n                                $(el).closest(\".site-wrapper\").replaceWith(html);\n                                updateProductEmptyMessage();\n                            });\n                        } else {\n                            alertP(\"Oops! Something went wrong.\", \"Unable to edit site, please try again later.\");\n                        }\n                    })\n                }\n                //PRICE FOUND\n                else {\n                    showLoading();\n                    showSelectPricePopup({\n                        \"site_url\": $txtSiteURL.val()\n                    }, function (editSiteData) {\n                        editSite({\n                            \"site_url\": $txtSiteURL.val(),\n                            \"domain_id\": editSiteData.domain_id,\n                            \"site_id\": editSiteData.site_id,\n                            \"domain_price\": editSiteData.domain_price,\n                            \"comment\": editSiteData.comment,\n                            \"url\": $(el).attr(\"data-url\")\n                        }, function (edit_site_response) {\n                            if (edit_site_response.status == true) {\n                                loadSingleSite(edit_site_response.site.urls.show, function (html) {\n                                    toggleEditSiteURL($(el).closest(\".site-wrapper\").find(\"btn-edit-site\").get(0));\n                                    $(el).closest(\".site-wrapper\").replaceWith(html);\n                                    updateProductEmptyMessage();\n                                });\n                            } else {\n                                alertP(\"Oops! Something went wrong.\", \"Unable to edit site, please try again later.\");\n                            }\n                        });\n                    });\n                }\n            } else {\n                alertP(\"Oops! Something went wrong.\", 'Unable to update Product Page URL, please try again later.');\n            }\n        },\n        \"error\": function (xhr, status, error) {\n            hideLoading();\n            if (xhr.responseJSON != null && typeof xhr.responseJSON != 'undefined') {\n                var errorMsg = \"\";\n                $.each(xhr.responseJSON, function (key, error) {\n                    $.each(error, function (index, message) {\n                        errorMsg += message + \" \";\n                    })\n                });\n                alertP(\"Oops! Something went wrong.\", errorMsg);\n            } else {\n                describeServerRespondedError(xhr.status);\n            }\n        }\n    })\n}\n\nfunction editSite(data, callback) {\n    showLoading();\n    $.ajax({\n        \"url\": data.url,\n        \"method\": \"put\",\n        \"data\": data,\n        \"dataType\": \"json\",\n        \"success\": function (response) {\n            hideLoading();\n            if ($.isFunction(callback)) {\n                callback(response);\n            }\n        },\n        \"error\": function (xhr, status, error) {\n            hideLoading();\n            if (xhr.responseJSON != null && typeof xhr.responseJSON != 'undefined') {\n                var errorMsg = \"\";\n                $.each(xhr.responseJSON, function (key, error) {\n                    $.each(error, function (index, message) {\n                        errorMsg += message + \" \";\n                    })\n                });\n                alertP(\"Oops! Something went wrong.\", errorMsg);\n            } else {\n                describeServerRespondedError(xhr.status);\n            }\n        }\n    })\n}\n\nfunction showSelectPricePopup(data, callback) {\n    showLoading();\n    $.ajax({\n        \"url\": \"/site/prices\",\n        \"method\": \"post\",\n        \"data\": data,\n        \"success\": function (html) {\n            hideLoading();\n            var $modal = $(html);\n            $modal.modal();\n            $modal.on(\"shown.bs.modal\", function () {\n                if ($.isFunction(modalReady)) {\n                    modalReady({\n                        \"callback\": function (response) {\n                            if ($.isFunction(callback)) {\n                                callback(response);\n                            }\n                        }\n                    })\n                }\n            });\n            $modal.on(\"hidden.bs.modal\", function () {\n                $(\"#modal-site-prices\").remove();\n            });\n        },\n        \"error\": function (xhr, status, error) {\n            hideLoading();\n            describeServerRespondedError(xhr.status);\n        }\n    });\n}\n\n\nfunction showSiteAlertForm(el) {\n    showLoading();\n    $.ajax({\n        \"url\": $(el).closest(\".site-wrapper\").attr(\"data-site-alert-url\"),\n        \"method\": \"get\",\n        \"success\": function (html) {\n            hideLoading();\n            var $modal = $(html);\n            $modal.modal();\n            $modal.on(\"shown.bs.modal\", function () {\n                if ($.isFunction(modalReady)) {\n                    modalReady({\n                        \"updateCallback\": function (response) {\n                            if (response.status == true) {\n                                $(el).find(\"i\").removeClass().addClass(\"fa fa-bell alert-enabled\");\n                            }\n                        },\n                        \"deleteCallback\": function (response) {\n                            if (response.status == true) {\n                                $(el).find(\"i\").removeClass().addClass(\"fa fa-bell-o\");\n                            }\n                        }\n                    })\n                }\n            });\n            $modal.on(\"hidden.bs.modal\", function () {\n                $(\"#modal-alert-site\").remove();\n            });\n        },\n        \"error\": function (xhr, status, error) {\n            hideLoading();\n            describeServerRespondedError(xhr.status);\n        }\n    });\n}\n\nfunction toggleMyPrice(el) {\n    if (($(el).attr(\"data-product-alert-on-my-price\") == 'y' || $(el).attr(\"data-site-alerts-on-my-price\") > 0) && $(el).find(\"i\").hasClass(\"text-primary\")) {\n        deletePopup(\"My Price\", \"Do you want to disable 'My Price'?\",\n            \"By updating my price, you will lose the following data:\",\n            [\n                \"My Price related alerts\"\n            ],\n            {\n                \"affirmative\": {\n                    \"text\": \"DELETE\",\n                    \"class\": \"btn-danger btn-flat\",\n                    \"dismiss\": true,\n                    \"callback\": function () {\n                        submitToggleMyPrice(el);\n                    }\n                },\n                \"negative\": {\n                    \"text\": \"CANCEL\",\n                    \"class\": \"btn-default btn-flat\",\n                    \"dismiss\": true\n                }\n            });\n    } else {\n        submitToggleMyPrice(el);\n    }\n}\n\nfunction submitToggleMyPrice(el) {\n    var myPrice = $(el).find(\"i\").hasClass(\"text-primary\") ? \"n\" : \"y\";\n    showLoading();\n\n    $.ajax({\n        \"url\": $(el).closest(\".site-wrapper\").attr(\"data-site-update-my-price-url\"),\n        \"method\": \"put\",\n        \"data\": {\n            \"my_price\": myPrice\n        },\n        \"dataType\": \"json\",\n        \"success\": function (response) {\n            hideLoading();\n            if (response.status == true) {\n                gaSetMyPrice();\n                showLoading();\n                $.ajax({\n                    \"url\": $(el).closest(\".site-wrapper\").attr(\"data-site-product-show-url\"),\n                    \"method\": \"get\",\n                    \"success\": function (html) {\n                        hideLoading();\n                        $(el).closest(\".product-wrapper\").replaceWith(html);\n                    },\n                    \"error\": function (xhr, status, error) {\n                        hideLoading();\n                        describeServerRespondedError(xhr.status);\n                    }\n                });\n            } else {\n                if (typeof response.errors != 'undefined') {\n                    var errorMessage = \"\";\n                    $.each(response.errors, function (index, error) {\n                        errorMessage += error + \" \";\n                    });\n                    alertP(\"Oops! Something went wrong.\", errorMessage);\n                } else {\n                    alertP(\"Oops! Something went wrong.\", \"unable to set my price, please try again later.\");\n                }\n            }\n        },\n        \"error\": function (xhr, status, error) {\n            hideLoading();\n            describeServerRespondedError(xhr.status);\n        }\n    })\n}\n\nfunction showSiteChart(url) {\n    showLoading();\n    $.ajax({\n        \"url\": url,\n        \"method\": \"get\",\n        \"success\": function (html) {\n            hideLoading();\n            var $modal = $(html);\n            $modal.modal();\n            $modal.on(\"shown.bs.modal\", function () {\n                if ($.isFunction(modalReady)) {\n                    modalReady()\n                }\n            });\n            $modal.on(\"hidden.bs.modal\", function () {\n                $(this).remove();\n            });\n        },\n        \"error\": function (xhr, status, error) {\n            hideLoading();\n            describeServerRespondedError(xhr.status);\n        }\n    });\n}\n\nfunction initPopover() {\n    $(\"[data-toggle=popover]\").popover();\n}\n"]}