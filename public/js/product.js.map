{"version":3,"sources":["single_category.js","single_product.js","single_site.js"],"names":[],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACxSA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACvdA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"product.js","sourcesContent":["\r\nfunction btnDeleteCategoryOnClick(el) {\r\n    deletePopup(\"Delete Category\", \"Are you sure you want to delete the \" + $(el).attr(\"data-name\") + \" Category?\",\r\n        \"By deleting this category, you will lose the following data:\",\r\n        [\r\n            \"All data related to the category you are tracking\",\r\n            \"All sites and products associated with this category\",\r\n            \"The charts of the category\",\r\n            \"The presentation of the data\"\r\n        ],\r\n        {\r\n            \"affirmative\": {\r\n                \"text\": \"Delete\",\r\n                \"class\": \"btn-danger btn-flat\",\r\n                \"dismiss\": true,\r\n                \"callback\": function () {\r\n                    var $form = $(el).closest(\".frm-delete-category\");\r\n                    showLoading();\r\n                    $.ajax({\r\n                        \"url\": $form.attr(\"action\"),\r\n                        \"method\": \"delete\",\r\n                        \"data\": $form.serialize(),\r\n                        \"dataType\": \"json\",\r\n                        \"success\": function (response) {\r\n                            hideLoading();\r\n                            if (response.status == true) {\r\n                                gaDeleteCategory();\r\n                                alertP(\"Delete Category\", \"Category has been deleted.\");\r\n                                $(el).closest(\".category-wrapper\").remove();\r\n                                updateUserProductCredit();\r\n                            } else {\r\n                                alertP(\"Error\", \"Unable to delete category, please try again later.\");\r\n                            }\r\n                        },\r\n                        \"error\": function (xhr, status, error) {\r\n                            hideLoading();\r\n                            describeServerRespondedError(xhr.status);\r\n                        }\r\n                    })\r\n                }\r\n            },\r\n            \"negative\": {\r\n                \"text\": \"Cancel\",\r\n                \"class\": \"btn-default btn-flat\",\r\n                \"dismiss\": true\r\n            }\r\n        });\r\n}\r\n\r\nfunction appendCreateProductBlock(el) {\r\n    $(el).find(\".add-item-label\").slideUp();\r\n    $(el).find(\".add-item-controls\").slideDown();\r\n    $(el).find(\".txt-product-name\").focus();\r\n}\r\n\r\nfunction appendUpgradeForCreateProductBlock(el) {\r\n    $(el).find(\".add-item-label\").slideUp();\r\n    $(el).find(\".upgrade-for-add-item-controls\").slideDown();\r\n}\r\n\r\nfunction cancelAddProduct(el) {\r\n    $(el).closest(\".add-item-block\").find(\".add-item-label\").slideDown();\r\n    $(el).closest(\".add-item-block\").find(\".add-item-controls\").slideUp();\r\n    $(el).closest(\".add-item-block\").find(\".add-item-controls input\").val(\"\");\r\n}\r\n\r\n\r\nfunction btnAddProductOnClick(el) {\r\n    showLoading();\r\n    $.ajax({\r\n        \"url\": \"/product\",\r\n        \"method\": \"post\",\r\n        \"data\": {\r\n            \"category_id\": $(el).closest(\".category-wrapper\").attr('data-category-id'),\r\n            \"product_name\": $(el).closest(\".category-wrapper\").find(\".txt-product-name\").val()\r\n        },\r\n        \"dataType\": \"json\",\r\n        \"success\": function (response) {\r\n            hideLoading();\r\n            if (response.status == true) {\r\n                cancelAddProduct($(el).closest(\".category-wrapper\").find(\".btn-cancel-add-product\"));\r\n                gaAddProduct();\r\n                if (response.product != null) {\r\n                    showLoading();\r\n                    loadSingleProduct(response.product.urls.show, function (html) {\r\n                        hideLoading();\r\n                        $(el).closest(\".tbl-category\").find(\".collapsible-category-div\").prepend(html);\r\n                        updateProductOrder($(el).closest(\".category-wrapper\").attr('data-category-id'));\r\n                        updateProductEmptyMessage();\r\n                        updateUserProductCredit();\r\n                    });\r\n                } else {\r\n                    alertP(\"Create product\", \"product has been created. But encountered error while page being loaded.\", function () {\r\n                        window.location.reload();\r\n                    });\r\n                }\r\n            } else {\r\n                var errorMsg = \"Unable to add product. \";\r\n                if (response.errors != null) {\r\n                    $.each(response.errors, function (index, error) {\r\n                        errorMsg += error + \" \";\r\n                    })\r\n                }\r\n                alertP(\"Error\", errorMsg);\r\n            }\r\n        },\r\n        \"error\": function (xhr, status, error) {\r\n            hideLoading();\r\n            describeServerRespondedError(xhr.status);\r\n        }\r\n    })\r\n}\r\n\r\nfunction loadSingleProduct(url, callback) {\r\n    $.ajax({\r\n        \"url\": url,\r\n        \"method\": \"get\",\r\n        \"success\": callback,\r\n        \"error\": function (xhr, status, error) {\r\n            hideLoading();\r\n            describeServerRespondedError(xhr.status);\r\n        }\r\n    });\r\n}\r\n\r\n\r\nfunction toggleEditCategoryName(el) {\r\n    var $tbl = $(el).closest(\".tbl-category\");\r\n    if ($(el).hasClass(\"editing\")) {\r\n        $(el).removeClass(\"editing\");\r\n        $tbl.find(\".category-name-link\").show();\r\n        $tbl.find(\".frm-edit-category\").hide();\r\n    } else {\r\n        $tbl.find(\".category-name-link\").hide();\r\n        $tbl.find(\".frm-edit-category\").show();\r\n        $tbl.find(\".frm-edit-category .category-name\").focus();\r\n        $(el).addClass(\"editing\");\r\n    }\r\n}\r\n\r\nfunction submitEditCategoryName(el) {\r\n    showLoading();\r\n    $.ajax({\r\n        \"url\": $(el).attr(\"action\"),\r\n        \"method\": \"put\",\r\n        \"data\": $(el).serialize(),\r\n        \"dataType\": \"json\",\r\n        \"success\": function (response) {\r\n            hideLoading();\r\n            if (response.status == true) {\r\n                gaEditCategory();\r\n                alertP(\"Update Category\", \"Category name has been updated.\");\r\n                $(el).siblings(\".category-name-link\").text($(el).find(\".category-name\").val()).show();\r\n                $(el).hide();\r\n                $(el).closest(\".tbl-category\").find(\".btn-action.editing\").removeClass(\"editing\");\r\n            } else {\r\n                var errorMsg = \"Unable to edit category name. \";\r\n                if (response.errors != null) {\r\n                    $.each(response.errors, function (index, error) {\r\n                        errorMsg += error + \" \";\r\n                    })\r\n                }\r\n                alertP(\"Error\", errorMsg);\r\n            }\r\n        },\r\n        \"error\": function (xhr, status, error) {\r\n            hideLoading();\r\n            describeServerRespondedError(xhr.status);\r\n        }\r\n    });\r\n}\r\n\r\nfunction assignProductOrderNumber(category_id) {\r\n    $(\".category-wrapper\").filter(function () {\r\n        return $(this).attr(\"data-category-id\") == category_id;\r\n    }).find(\".product-wrapper\").each(function (index) {\r\n        $(this).attr(\"data-order\", index + 1);\r\n    });\r\n}\r\n\r\nfunction updateProductOrder(category_id) {\r\n    assignProductOrderNumber(category_id);\r\n    var orderList = [];\r\n    $(\".category-wrapper\").filter(function () {\r\n        return $(this).attr(\"data-category-id\") == category_id;\r\n    }).find(\".product-wrapper\").filter(function () {\r\n        return !$(this).hasClass(\"gu-mirror\");\r\n    }).each(function () {\r\n        if ($(this).attr(\"data-product-id\")) {\r\n            var productId = $(this).attr(\"data-product-id\");\r\n            var productOrder = parseInt($(this).attr(\"data-order\"));\r\n            orderList.push({\r\n                \"product_id\": productId,\r\n                \"product_order\": productOrder\r\n            });\r\n        }\r\n    });\r\n    $.ajax({\r\n        \"url\": \"product/order\",\r\n        \"method\": \"put\",\r\n        \"data\": {\r\n            \"order\": orderList\r\n        },\r\n        \"dataType\": \"json\",\r\n        \"success\": function (response) {\r\n            if (response.status == false) {\r\n                alertP(\"Error\", \"Unable to update product order, please try again later.\");\r\n            } else {\r\n                gaMoveProduct();\r\n            }\r\n        },\r\n        \"error\": function (xhr, status, error) {\r\n            describeServerRespondedError(xhr.status);\r\n        }\r\n    })\r\n}\r\n\r\nfunction showCategoryChart(url) {\r\n    showLoading();\r\n    $.ajax({\r\n        \"url\": url,\r\n        \"method\": \"get\",\r\n        \"success\": function (html) {\r\n            hideLoading();\r\n            var $modal = $(html);\r\n            $modal.modal();\r\n            $modal.on(\"shown.bs.modal\", function () {\r\n                if ($.isFunction(modalReady)) {\r\n                    modalReady()\r\n                }\r\n            });\r\n            $modal.on(\"hidden.bs.modal\", function () {\r\n                $(this).remove();\r\n            });\r\n        },\r\n        \"error\": function (xhr, status, error) {\r\n            hideLoading();\r\n            describeServerRespondedError(xhr.status);\r\n        }\r\n    });\r\n}\r\n\r\n\r\nfunction showCategoryReportTaskForm(el) {\r\n    showLoading();\r\n    $.ajax({\r\n        \"url\": $(el).closest(\".category-wrapper\").attr(\"data-report-task-link\"),\r\n        \"method\": \"get\",\r\n        \"success\": function (html) {\r\n            hideLoading();\r\n            var $modal = $(html);\r\n            $modal.modal();\r\n            $modal.on(\"shown.bs.modal\", function () {\r\n                if ($.isFunction(modalReady)) {\r\n                    modalReady({\r\n                        \"updateCallback\": function (response) {\r\n                            if (response.status == true) {\r\n                                $(el).find(\"i\").removeClass().addClass(\"fa fa-envelope text-success\");\r\n                            }\r\n                        },\r\n                        \"deleteCallback\": function (response) {\r\n                            if (response.status == true) {\r\n                                $(el).find(\"i\").removeClass().addClass(\"fa fa-envelope-o\");\r\n                            }\r\n                        }\r\n                    })\r\n                }\r\n            });\r\n            $modal.on(\"hidden.bs.modal\", function () {\r\n                $(\"#modal-report-task-category\").remove();\r\n            });\r\n        },\r\n        \"error\": function (xhr, status, error) {\r\n            hideLoading();\r\n            describeServerRespondedError(xhr.status);\r\n        }\r\n    });\r\n}\r\n\r\n\r\nfunction updateUserSiteUsage(el) {\r\n    $.ajax({\r\n        \"url\": $(el).closest(\".category-wrapper\").attr(\"data-get-site-usage-link\"),\r\n        \"method\": \"get\",\r\n        \"dataType\": \"json\",\r\n        \"success\": function (response) {\r\n            if (response.status == true) {\r\n                var usage = response.usage;\r\n                var $categoryWrapper = $(el).closest(\".category-wrapper\")\r\n                $categoryWrapper.find(\".lbl-site-usage\").text(usage);\r\n            }\r\n        },\r\n        \"error\": function (xhr, status, error) {\r\n            describeServerRespondedError(xhr.status);\r\n        }\r\n    })\r\n}","\r\n/**\r\n * set order number to element\r\n * @param product_id\r\n */\r\nfunction assignSiteOrderNumber(product_id) {\r\n    $(\".product-wrapper\").filter(function () {\r\n        return $(this).attr(\"data-product-id\") == product_id;\r\n    }).find(\".site-wrapper\").each(function (index) {\r\n        $(this).attr(\"data-order\", index + 1);\r\n    });\r\n}\r\n\r\n/**\r\n * Send order number to server\r\n * @param product_id\r\n */\r\nfunction updateSiteOrder(product_id) {\r\n    assignSiteOrderNumber(product_id);\r\n    var orderList = [];\r\n    $(\".product-wrapper\").filter(function () {\r\n        return $(this).attr(\"data-product-id\") == product_id;\r\n    }).find(\".site-wrapper\").filter(function () {\r\n        return !$(this).hasClass(\"gu-mirror\");\r\n    }).each(function () {\r\n        if ($(this).attr(\"data-site-id\")) {\r\n            var siteId = $(this).attr(\"data-site-id\");\r\n            var siteOrder = parseInt($(this).attr(\"data-order\"));\r\n            orderList.push({\r\n                \"site_id\": siteId,\r\n                \"site_order\": siteOrder\r\n            });\r\n        }\r\n    });\r\n    $.ajax({\r\n        \"url\": \"/site/order\",\r\n        \"method\": \"put\",\r\n        \"data\": {\r\n            \"order\": orderList\r\n        },\r\n        \"dataType\": \"json\",\r\n        \"success\": function (response) {\r\n            if (response.status == false) {\r\n                alertP(\"Error\", \"Unable to update site order, please try again later.\");\r\n            } else {\r\n                gaMoveSite();\r\n            }\r\n        },\r\n        \"error\": function (xhr, status, error) {\r\n            describeServerRespondedError(xhr.status);\r\n        }\r\n    })\r\n}\r\nfunction appendCreateSiteBlock(el) {\r\n    $(el).find(\".add-item-label\").slideUp();\r\n    $(el).find(\".add-item-controls\").slideDown();\r\n    $(el).find(\".txt-site-url\").focus();\r\n}\r\nfunction appendUpgradeForCreateSiteBlock(el) {\r\n    $(el).find(\".add-item-label\").slideUp();\r\n    $(el).find(\".upgrade-for-add-item-controls\").slideDown();\r\n}\r\n/**\r\n * disable add site\r\n * @param el\r\n */\r\nfunction cancelAddSite(el) {\r\n    $(el).closest(\".add-item-block\").find(\".add-item-label\").slideDown();\r\n    $(el).closest(\".add-item-block\").find(\".add-item-controls\").slideUp();\r\n    $(el).closest(\".add-item-block\").find(\".add-item-controls input\").val(\"\");\r\n}\r\nfunction getPricesCreate(el) {\r\n    var $addItemControls = $(el).closest(\".add-item-controls\");\r\n    var $txtSiteURL = $addItemControls.find(\".txt-site-url\");\r\n    var productID = $(el).closest(\".product-wrapper\").attr(\"data-product-id\");\r\n    showLoading();\r\n    $.ajax({\r\n        \"url\": \"/site/prices\",\r\n        \"method\": \"get\",\r\n        \"data\": {\r\n            \"site_url\": $txtSiteURL.val()\r\n        },\r\n        \"dataType\": \"json\",\r\n        \"success\": function (response) {\r\n            if (typeof response.errors == 'undefined') {\r\n                if ((typeof response.sites == 'undefined' || response.sites.length == 0) && typeof response.targetDomain == 'undefined') {\r\n                    addSite({\r\n                        \"site_url\": $txtSiteURL.val(),\r\n                        \"product_id\": productID\r\n                    }, function (add_site_response) {\r\n                        if (add_site_response.status == true) {\r\n                            loadSingleSite(add_site_response.site.urls.show, function (html) {\r\n                                $(el).closest(\".tbl-site\").find(\"tbody\").prepend(html);\r\n                                cancelAddSite($addItemControls.find(\".btn-cancel-add-site\").get(0));\r\n                                updateProductEmptyMessage();\r\n                                updateUserSiteUsage(el);\r\n                                updateUserSiteUsagePerProduct(el);\r\n                            });\r\n                        } else {\r\n                            alertP(\"Error\", \"Unable to add site, please try again later.\");\r\n                        }\r\n                    })\r\n                } else {\r\n                    showLoading();\r\n                    $.ajax({\r\n                        \"url\": \"/site/prices\",\r\n                        \"method\": \"get\",\r\n                        \"data\": {\r\n                            \"site_url\": $txtSiteURL.val()\r\n                        },\r\n                        \"success\": function (html) {\r\n                            hideLoading();\r\n                            var $modal = $(html);\r\n                            $modal.modal();\r\n                            $modal.on(\"shown.bs.modal\", function () {\r\n                                if ($.isFunction(modalReady)) {\r\n                                    modalReady({\r\n                                        \"callback\": function (addSiteData) {\r\n                                            addSite({\r\n                                                \"site_url\": $txtSiteURL.val(),\r\n                                                \"domain_id\": addSiteData.domain_id,\r\n                                                \"site_id\": addSiteData.site_id,\r\n                                                \"product_id\": productID\r\n                                            }, function (add_site_response) {\r\n                                                if (add_site_response.status == true) {\r\n                                                    loadSingleSite(add_site_response.site.urls.show, function (html) {\r\n                                                        $(el).closest(\".tbl-site\").find(\"tbody\").prepend(html);\r\n                                                        cancelAddSite($addItemControls.find(\".btn-cancel-add-site\").get(0));\r\n                                                        updateProductEmptyMessage();\r\n                                                        updateUserSiteUsage(el);\r\n                                                        updateUserSiteUsagePerProduct(el);\r\n                                                    });\r\n                                                } else {\r\n                                                    alertP(\"Error\", \"Unable to add site, please try again later.\");\r\n                                                }\r\n                                                /*TODO big pb*/\r\n                                            });\r\n                                        }\r\n                                    })\r\n                                }\r\n                            });\r\n                            $modal.on(\"hidden.bs.modal\", function () {\r\n                                $(\"#modal-site-prices\").remove();\r\n                            });\r\n                        },\r\n                        \"error\": function (xhr, status, error) {\r\n                            hideLoading();\r\n                            describeServerRespondedError(xhr.status);\r\n                        }\r\n                    });\r\n                }\r\n            } else {\r\n                hideLoading();\r\n                var errorMsg = \"Unable to add site. \";\r\n                if (response.errors != null) {\r\n                    $.each(response.errors, function (index, error) {\r\n                        errorMsg += error + \" \";\r\n                    })\r\n                }\r\n                alertP(\"Error\", errorMsg);\r\n            }\r\n        },\r\n        \"error\": function (xhr, status, error) {\r\n            hideLoading();\r\n            describeServerRespondedError(xhr.status);\r\n        }\r\n    })\r\n}\r\n\r\nfunction addSite(data, callback) {\r\n    showLoading();\r\n    $.ajax({\r\n        \"url\": \"/site\",\r\n        \"method\": \"post\",\r\n        \"data\": data,\r\n        \"dataType\": \"json\",\r\n        \"success\": function (response) {\r\n            hideLoading();\r\n            if ($.isFunction(callback)) {\r\n                callback(response);\r\n            }\r\n        },\r\n        \"error\": function (xhr, status, error) {\r\n            hideLoading();\r\n            describeServerRespondedError(xhr.status);\r\n        }\r\n    })\r\n}\r\n\r\nfunction loadSingleSite(url, callback) {\r\n    showLoading();\r\n    $.ajax({\r\n        \"url\": url,\r\n        \"method\": \"get\",\r\n        \"success\": function (html) {\r\n            hideLoading();\r\n\r\n            if ($.isFunction(callback)) {\r\n                callback(html);\r\n            }\r\n        },\r\n        \"error\": function (xhr, status, error) {\r\n            hideLoading();\r\n            describeServerRespondedError(xhr.status);\r\n        }\r\n    });\r\n}\r\n\r\n\r\nfunction btnDeleteProductOnClick(el) {\r\n    deletePopup(\"Delete Product\", \"Are you sure you want to delete the \" + $(el).attr(\"data-name\") + \" Product?\",\r\n        \"By deleting this product, you will lose the following data:\",\r\n        [\r\n            \"All data related to the product you are tracking\",\r\n            \"All site associated with this product\",\r\n            \"The charts of the product\",\r\n            \"The presentation of the data\"\r\n        ],\r\n        {\r\n            \"affirmative\": {\r\n                \"text\": \"Delete\",\r\n                \"class\": \"btn-danger btn-flat\",\r\n                \"dismiss\": true,\r\n                \"callback\": function () {\r\n                    var $form = $(el).closest(\".frm-delete-product\");\r\n                    showLoading();\r\n                    $.ajax({\r\n                        \"url\": $form.attr(\"action\"),\r\n                        \"method\": \"delete\",\r\n                        \"data\": $form.serialize(),\r\n                        \"dataType\": \"json\",\r\n                        \"success\": function (response) {\r\n                            hideLoading();\r\n                            if (response.status == true) {\r\n                                gaDeleteProduct();\r\n                                alertP(\"Delete Product\", \"Product has been deleted.\");\r\n                                updateUserSiteUsage(el);\r\n                                $(el).closest(\".product-wrapper\").remove();\r\n                                updateUserProductCredit();\r\n                            } else {\r\n                                alertP(\"Error\", \"Unable to delete product, please try again later.\");\r\n                            }\r\n                        },\r\n                        \"error\": function (xhr, status, error) {\r\n                            hideLoading();\r\n                            describeServerRespondedError(xhr.status);\r\n                        }\r\n                    })\r\n                }\r\n            },\r\n            \"negative\": {\r\n                \"text\": \"Cancel\",\r\n                \"class\": \"btn-default btn-flat\",\r\n                \"dismiss\": true\r\n            }\r\n        });\r\n}\r\n\r\nfunction toggleEditProductName(el) {\r\n    var $tbl = $(el).closest(\".product-wrapper\");\r\n    if ($(el).hasClass(\"editing\")) {\r\n        $(el).removeClass(\"editing\");\r\n        $tbl.find(\".product-name-link\").show();\r\n        $tbl.find(\".frm-edit-product\").hide();\r\n    } else {\r\n        $tbl.find(\".product-name-link\").hide();\r\n        $tbl.find(\".frm-edit-product\").show();\r\n        $tbl.find(\".frm-edit-product .product-name\").focus();\r\n        $(el).addClass(\"editing\");\r\n    }\r\n}\r\n\r\nfunction submitEditProductName(el) {\r\n    showLoading();\r\n    $.ajax({\r\n        \"url\": $(el).attr(\"action\"),\r\n        \"method\": \"put\",\r\n        \"data\": $(el).serialize(),\r\n        \"dataType\": \"json\",\r\n        \"success\": function (response) {\r\n            hideLoading();\r\n            if (response.status == true) {\r\n                gaEditProduct();\r\n\r\n                alertP(\"Update Product\", \"Product name has been updated.\");\r\n                $(el).siblings(\".product-name-link\").text($(el).find(\".product-name\").val()).show();\r\n                $(el).hide();\r\n                $(el).closest(\".product-wrapper\").find(\".btn-action.editing\").removeClass(\"editing\");\r\n            } else {\r\n                var errorMsg = \"Unable to update product. \";\r\n                if (response.errors != null) {\r\n                    $.each(response.errors, function (index, error) {\r\n                        errorMsg += error + \" \";\r\n                    })\r\n                }\r\n                alertP(\"Error\", errorMsg);\r\n            }\r\n        },\r\n        \"error\": function (xhr, status, error) {\r\n            hideLoading();\r\n            describeServerRespondedError(xhr.status);\r\n        }\r\n    });\r\n}\r\n\r\nfunction showProductAlertForm(el) {\r\n    showLoading();\r\n    var productID = $(el).closest(\".product-wrapper\").attr(\"data-product-id\");\r\n\r\n    $.ajax({\r\n        \"url\": $(el).closest(\".product-wrapper\").attr(\"data-alert-link\"),\r\n        \"method\": \"get\",\r\n        \"data\": {\r\n            \"product_id\": productID\r\n        },\r\n        \"success\": function (html) {\r\n            hideLoading();\r\n            var $modal = $(html);\r\n            $modal.modal();\r\n            $modal.on(\"shown.bs.modal\", function () {\r\n                if ($.isFunction(modalReady)) {\r\n                    modalReady({\r\n                        \"updateCallback\": function (response) {\r\n                            if (response.status == true) {\r\n                                $(el).find(\"i\").removeClass().addClass(\"fa fa-bell alert-enabled\");\r\n                            }\r\n                        },\r\n                        \"deleteCallback\": function (response) {\r\n                            if (response.status == true) {\r\n                                $(el).find(\"i\").removeClass().addClass(\"fa fa-bell-o\");\r\n                            }\r\n                        }\r\n                    })\r\n                }\r\n            });\r\n            $modal.on(\"hidden.bs.modal\", function () {\r\n                $(\"#modal-alert-product\").remove();\r\n            });\r\n        },\r\n        \"error\": function (xhr, status, error) {\r\n            hideLoading();\r\n            describeServerRespondedError(xhr.status);\r\n        }\r\n    });\r\n}\r\n\r\nfunction showProductChart(url) {\r\n    showLoading();\r\n    $.ajax({\r\n        \"url\": url,\r\n        \"method\": \"get\",\r\n        \"success\": function (html) {\r\n            hideLoading();\r\n            var $modal = $(html);\r\n            $modal.modal();\r\n            $modal.on(\"shown.bs.modal\", function () {\r\n                if ($.isFunction(modalReady)) {\r\n                    modalReady()\r\n                }\r\n            });\r\n            $modal.on(\"hidden.bs.modal\", function () {\r\n                $(this).remove();\r\n            });\r\n        },\r\n        \"error\": function (xhr, status, error) {\r\n            hideLoading();\r\n            describeServerRespondedError(xhr.status);\r\n        }\r\n    });\r\n}\r\n\r\nfunction showProductReportTaskForm(el) {\r\n    showLoading();\r\n    $.ajax({\r\n        \"url\": $(el).closest(\".product-wrapper\").attr(\"data-report-task-link\"),\r\n        \"method\": \"get\",\r\n        \"success\": function (html) {\r\n            hideLoading();\r\n            var $modal = $(html);\r\n            $modal.modal();\r\n            $modal.on(\"shown.bs.modal\", function () {\r\n                if ($.isFunction(modalReady)) {\r\n                    modalReady({\r\n                        \"updateCallback\": function (response) {\r\n                            if (response.status == true) {\r\n                                $(el).find(\"i\").removeClass().addClass(\"fa fa-envelope text-success\");\r\n                            }\r\n                        },\r\n                        \"deleteCallback\": function (response) {\r\n                            if (response.status == true) {\r\n                                $(el).find(\"i\").removeClass().addClass(\"fa fa-envelope-o\");\r\n                            }\r\n                        }\r\n                    })\r\n                }\r\n            });\r\n            $modal.on(\"hidden.bs.modal\", function () {\r\n                $(\"#modal-report-task-product\").remove();\r\n            });\r\n        },\r\n        \"error\": function (xhr, status, error) {\r\n            hideLoading();\r\n            describeServerRespondedError(xhr.status);\r\n        }\r\n    });\r\n}\r\n\r\nfunction updateProductEmptyMessage(el) {\r\n    function updateSingleProductEmptyMessage(el) {\r\n        var $tblSite = null;\r\n        if ($(el).hasClass(\"tbl-site\")) {\r\n            $tblSite = $(el);\r\n        } else {\r\n            $tblSite = $(el).find(\".tbl-site\");\r\n        }\r\n\r\n        var $bodyRow = $tblSite.find(\"tbody > tr\").filter(function () {\r\n            return !$(this).hasClass(\"empty-message-row\") && !$(this).hasClass(\"add-site-row\")\r\n        });\r\n        if ($bodyRow.length == 0) {\r\n            $tblSite.find(\".empty-message-row\").remove();\r\n            $tblSite.find(\"tbody\").prepend(\r\n                $(\"<tr>\").addClass(\"empty-message-row\").append(\r\n                    $(\"<td>\").attr({\r\n                        \"colspan\": 8\r\n                    }).addClass(\"text-center\").text(\"To start tracking prices, simply copy and paste the URL of the product page of the website your want to track.\")\r\n                )\r\n            )\r\n        } else {\r\n            $tblSite.find(\".empty-message-row\").remove();\r\n        }\r\n    }\r\n\r\n    if (typeof el != 'undefined') {\r\n        updateSingleProductEmptyMessage(el);\r\n    } else {\r\n        $(\".tbl-site\").each(function () {\r\n            updateSingleProductEmptyMessage(this);\r\n        })\r\n    }\r\n}\r\n\r\nfunction updateUserSiteUsagePerProduct(el) {\r\n    var $productWrapper = $(el).closest(\".product-wrapper\");\r\n    $.ajax({\r\n        \"url\": $productWrapper.attr(\"data-get-site-usage-per-product-link\"),\r\n        \"method\": \"get\",\r\n        \"dataType\": \"json\",\r\n        \"success\": function (response) {\r\n            if (response.status == true) {\r\n                var total = response.total;\r\n                var usage = response.usage;\r\n                $productWrapper.find(\".lbl-site-usage-per-product\").text(usage);\r\n                $productWrapper.find(\".lbl-site-total-per-product\").text(total);\r\n                updateAddSitePanelStatus(usage, total, el);\r\n            }\r\n        },\r\n        \"error\": function (xhr, status, error) {\r\n            describeServerRespondedError(xhr.status);\r\n        }\r\n    })\r\n}\r\n\r\nfunction updateAddSitePanelStatus(usage, total, el) {\r\n    var $productWrapper = $(el).closest(\".product-wrapper\");\r\n    var $addSiteContainer = $productWrapper.find(\".add-site-container\");\r\n    if (usage >= total) {\r\n        $addSiteContainer.attr('onclick', 'appendUpgradeForCreateSiteBlock(this); event.stopPropagation(); return false;');\r\n    } else {\r\n        $addSiteContainer.attr('onclick', 'appendCreateSiteBlock(this); event.stopPropagation(); return false;');\r\n    }\r\n}","\r\nfunction btnDeleteSiteOnClick(el) {\r\n    deletePopup(\"Delete Site\", \"Are you sure you want to delete the \" + $(el).attr(\"data-name\") + \" Site?\",\r\n        \"By deleting this site, you will lose the following data:\",\r\n        [\r\n            \"All data related to the site you are tracking\",\r\n            \"The charts of the site\",\r\n            \"The presentation of the data\"\r\n        ],\r\n        {\r\n            \"affirmative\": {\r\n                \"text\": \"Delete\",\r\n                \"class\": \"btn-danger btn-flat\",\r\n                \"dismiss\": true,\r\n                \"callback\": function () {\r\n                    var $form = $(el).closest(\".frm-delete-site\");\r\n                    showLoading();\r\n                    $.ajax({\r\n                        \"url\": $form.attr(\"action\"),\r\n                        \"method\": \"delete\",\r\n                        \"data\": $form.serialize(),\r\n                        \"dataType\": \"json\",\r\n                        \"success\": function (response) {\r\n                            hideLoading();\r\n                            if (response.status == true) {\r\n                                gaDeleteSite();\r\n                                alertP(\"Delete Site\", \"The site has been deleted.\");\r\n                                updateUserSiteUsage(el);\r\n                                updateUserSiteUsagePerProduct(el);\r\n                                $(el).closest(\".site-wrapper\").remove();\r\n                            } else {\r\n                                alertP(\"Error\", \"Unable to delete site, please try again later.\");\r\n                            }\r\n                            updateProductEmptyMessage();\r\n                        },\r\n                        \"error\": function (xhr, status, error) {\r\n                            hideLoading();\r\n                            describeServerRespondedError(xhr.status);\r\n                        }\r\n                    })\r\n                }\r\n            },\r\n            \"negative\": {\r\n                \"text\": \"Cancel\",\r\n                \"class\": \"btn-default btn-flat\",\r\n                \"dismiss\": true\r\n            }\r\n        });\r\n}\r\n\r\nfunction toggleEditSiteURL(el) {\r\n    var $tr = $(el).closest(\".site-wrapper\");\r\n    if ($(el).hasClass(\"editing\")) {\r\n        $(el).removeClass(\"editing\");\r\n        $tr.find(\".site-url-link\").show();\r\n        $tr.find(\".frm-edit-site-url\").hide();\r\n    } else {\r\n        $tr.find(\".site-url-link\").hide();\r\n        $tr.find(\".frm-edit-site-url\").show();\r\n        $tr.find(\".frm-edit-site-url .txt-site-url\").focus();\r\n        $(el).addClass(\"editing\");\r\n    }\r\n}\r\n\r\nfunction getPricesEdit(el) {\r\n    var $formEditSiteURL = $(el).closest(\".frm-edit-site-url\");\r\n    var $txtSiteURL = $formEditSiteURL.find(\".txt-site-url\");\r\n    var $siteWrapper = $(el).closest(\".site-wrapper\");\r\n    var siteID = $siteWrapper.attr(\"data-site-id\");\r\n    showLoading();\r\n    $.ajax({\r\n        \"url\": \"/site/prices\",\r\n        \"method\": \"get\",\r\n        \"data\": {\r\n            \"site_url\": $txtSiteURL.val(),\r\n            \"site_id\": siteID\r\n        },\r\n        \"dataType\": \"json\",\r\n        \"success\": function (response) {\r\n            hideLoading();\r\n            if (typeof response.errors == 'undefined') {\r\n                //PRICE NOT FOUND\r\n                if ((typeof response.sites == 'undefined' || response.sites.length == 0) && typeof response.targetDomain == 'undefined') {\r\n                    editSite({\r\n                        \"site_url\": $txtSiteURL.val(),\r\n                        \"url\": $(el).attr(\"data-url\")\r\n                    }, function (edit_site_response) {\r\n                        if (edit_site_response.status == true) {\r\n                            loadSingleSite(edit_site_response.site.urls.show, function (html) {\r\n                                toggleEditSiteURL($(el).closest(\".site-wrapper\").find(\"btn-edit-site\").get(0));\r\n                                $(el).closest(\".site-wrapper\").replaceWith(html);\r\n                                updateProductEmptyMessage();\r\n                            });\r\n                        } else {\r\n                            alertP(\"Error\", \"Unable to add site, please try again later.\");\r\n                        }\r\n                    })\r\n                }\r\n                //PRICE FOUND\r\n                else {\r\n                    showLoading();\r\n                    showSelectPricePopup({\r\n                        \"site_url\": $txtSiteURL.val()\r\n                    }, function (editSiteData) {\r\n                        editSite({\r\n                            \"site_url\": $txtSiteURL.val(),\r\n                            \"domain_id\": editSiteData.domain_id,\r\n                            \"site_id\": editSiteData.site_id,\r\n                            \"url\": $(el).attr(\"data-url\")\r\n                        }, function (edit_site_response) {\r\n                            if (edit_site_response.status == true) {\r\n                                loadSingleSite(edit_site_response.site.urls.show, function (html) {\r\n                                    toggleEditSiteURL($(el).closest(\".site-wrapper\").find(\"btn-edit-site\").get(0));\r\n                                    $(el).closest(\".site-wrapper\").replaceWith(html);\r\n                                    updateProductEmptyMessage();\r\n                                });\r\n                            } else {\r\n                                alertP(\"Error\", \"Unable to add site, please try again later.\");\r\n                            }\r\n                        });\r\n                    });\r\n                }\r\n            } else {\r\n                var errorMsg = \"Unable to edit site. \";\r\n                if (response.errors != null) {\r\n                    $.each(response.errors, function (index, error) {\r\n                        errorMsg += error + \" \";\r\n                    })\r\n                }\r\n                alertP(\"Error\", errorMsg);\r\n            }\r\n        },\r\n        \"error\": function (xhr, status, error) {\r\n            hideLoading();\r\n            describeServerRespondedError(xhr.status);\r\n        }\r\n    })\r\n}\r\n\r\nfunction editSite(data, callback) {\r\n    showLoading();\r\n    $.ajax({\r\n        \"url\": data.url,\r\n        \"method\": \"put\",\r\n        \"data\": data,\r\n        \"dataType\": \"json\",\r\n        \"success\": function (response) {\r\n            hideLoading();\r\n            if ($.isFunction(callback)) {\r\n                callback(response);\r\n            }\r\n        },\r\n        \"error\": function (xhr, status, error) {\r\n            hideLoading();\r\n            describeServerRespondedError(xhr.status);\r\n        }\r\n    })\r\n}\r\n\r\nfunction showSelectPricePopup(data, callback) {\r\n    showLoading();\r\n    $.ajax({\r\n        \"url\": \"/site/prices\",\r\n        \"method\": \"get\",\r\n        \"data\": data,\r\n        \"success\": function (html) {\r\n            hideLoading();\r\n            var $modal = $(html);\r\n            $modal.modal();\r\n            $modal.on(\"shown.bs.modal\", function () {\r\n                if ($.isFunction(modalReady)) {\r\n                    modalReady({\r\n                        \"callback\": function (response) {\r\n                            if ($.isFunction(callback)) {\r\n                                callback(response);\r\n                            }\r\n                        }\r\n                    })\r\n                }\r\n            });\r\n            $modal.on(\"hidden.bs.modal\", function () {\r\n                $(\"#modal-site-prices\").remove();\r\n            });\r\n        },\r\n        \"error\": function (xhr, status, error) {\r\n            hideLoading();\r\n            describeServerRespondedError(xhr.status);\r\n        }\r\n    });\r\n}\r\n\r\n\r\nfunction showSiteAlertForm(el) {\r\n    showLoading();\r\n    $.ajax({\r\n        \"url\": $(el).closest(\".site-wrapper\").attr(\"data-site-alert-url\"),\r\n        \"method\": \"get\",\r\n        \"success\": function (html) {\r\n            hideLoading();\r\n            var $modal = $(html);\r\n            $modal.modal();\r\n            $modal.on(\"shown.bs.modal\", function () {\r\n                if ($.isFunction(modalReady)) {\r\n                    modalReady({\r\n                        \"updateCallback\": function (response) {\r\n                            if (response.status == true) {\r\n                                $(el).find(\"i\").removeClass().addClass(\"fa fa-bell alert-enabled\");\r\n                            }\r\n                        },\r\n                        \"deleteCallback\": function (response) {\r\n                            if (response.status == true) {\r\n                                $(el).find(\"i\").removeClass().addClass(\"fa fa-bell-o\");\r\n                            }\r\n                        }\r\n                    })\r\n                }\r\n            });\r\n            $modal.on(\"hidden.bs.modal\", function () {\r\n                $(\"#modal-alert-site\").remove();\r\n            });\r\n        },\r\n        \"error\": function (xhr, status, error) {\r\n            hideLoading();\r\n            describeServerRespondedError(xhr.status);\r\n        }\r\n    });\r\n}\r\n\r\nfunction toggleMyPrice(el) {\r\n    if (($(el).attr(\"data-product-alert-on-my-price\") == 'y' || $(el).attr(\"data-site-alerts-on-my-price\") > 0) && $(el).find(\"i\").hasClass(\"text-primary\")) {\r\n        deletePopup(\"My Price\", \"Do you want to disable 'My Price'?\",\r\n            \"By updating my price, you will lose the following data:\",\r\n            [\r\n                \"My Price related alerts\"\r\n            ],\r\n            {\r\n                \"affirmative\": {\r\n                    \"text\": \"Delete\",\r\n                    \"class\": \"btn-danger btn-flat\",\r\n                    \"dismiss\": true,\r\n                    \"callback\": function () {\r\n                        submitToggleMyPrice(el);\r\n                    }\r\n                },\r\n                \"negative\": {\r\n                    \"text\": \"Cancel\",\r\n                    \"class\": \"btn-default btn-flat\",\r\n                    \"dismiss\": true\r\n                }\r\n            });\r\n    } else {\r\n        submitToggleMyPrice(el);\r\n    }\r\n}\r\n\r\nfunction submitToggleMyPrice(el) {\r\n    var myPrice = $(el).find(\"i\").hasClass(\"text-primary\") ? \"n\" : \"y\";\r\n    showLoading();\r\n\r\n    $.ajax({\r\n        \"url\": $(el).closest(\".site-wrapper\").attr(\"data-site-update-my-price-url\"),\r\n        \"method\": \"put\",\r\n        \"data\": {\r\n            \"my_price\": myPrice\r\n        },\r\n        \"dataType\": \"json\",\r\n        \"success\": function (response) {\r\n            hideLoading();\r\n            if (response.status == true) {\r\n                gaSetMyPrice();\r\n                showLoading();\r\n                $.ajax({\r\n                    \"url\": $(el).closest(\".site-wrapper\").attr(\"data-site-product-show-url\"),\r\n                    \"method\": \"get\",\r\n                    \"success\": function (html) {\r\n                        hideLoading();\r\n                        $(el).closest(\".product-wrapper\").replaceWith(html);\r\n                    },\r\n                    \"error\": function (xhr, status, error) {\r\n                        hideLoading();\r\n                        describeServerRespondedError(xhr.status);\r\n                    }\r\n                });\r\n            } else {\r\n                alertP(\"Error\", \"unable to set my price, please try again later.\");\r\n            }\r\n        },\r\n        \"error\": function () {\r\n            hideLoading();\r\n            describeServerRespondedError(xhr.status);\r\n        }\r\n    })\r\n}\r\n\r\nfunction showSiteChart(url) {\r\n    showLoading();\r\n    $.ajax({\r\n        \"url\": url,\r\n        \"method\": \"get\",\r\n        \"success\": function (html) {\r\n            hideLoading();\r\n            var $modal = $(html);\r\n            $modal.modal();\r\n            $modal.on(\"shown.bs.modal\", function () {\r\n                if ($.isFunction(modalReady)) {\r\n                    modalReady()\r\n                }\r\n            });\r\n            $modal.on(\"hidden.bs.modal\", function () {\r\n                $(this).remove();\r\n            });\r\n        },\r\n        \"error\": function (xhr, status, error) {\r\n            hideLoading();\r\n            describeServerRespondedError(xhr.status);\r\n        }\r\n    });\r\n}\r\n\r\nfunction initPopover() {\r\n    $(\"[data-toggle=popover]\").popover();\r\n}\r\n"]}